---
title: çŠ¶æ€ç®¡ç† (store)
---

çŠ¶æ€ç®¡ç†ä¸º redux ç³»åˆ—ï¼Œè€ŒåŸç”Ÿ redux è¾ƒä¸ºç¹çï¼Œç‰¹æ­¤é‡‡ç”¨ [`redux-toolkit`](https://redux-toolkit.js.org/)

### index.ts å‡ºå£

_index.ts_ é‡Œä¸»è¦æ˜¯å¯¹ _store_ çš„ _å‡ºå£_ è¿›è¡Œæ§åˆ¶ï¼Œè€Œæœ‰å“ªäº›å†…å®¹è¦ä» _store_ è¿™ä¸ªå‡ºå£ _å‡ºå»_ çš„å‘¢ï¼Ÿ

æ¯”å¦‚ç›¸å…³çš„æ ¸å¿ƒæ–¹æ³•ï¼Œ`useAppState` ã€`useAppDispatch` ã€`getAppState`

ä»¥åŠå„æ¨¡å—çš„ `Action` ä¸ `Thunk` é›†åˆã€‚

```tsx title="ä¸»å‡ºå£äº /src/store/index.ts ä¸­"
import { configureStore } from '@reduxjs/toolkit';
import { useDispatch, useSelector } from 'react-redux';
import rootReducers from './rootReducers';

const store = configureStore({
  reducer: rootReducers
});

export { default as rootActions } from './rootActions';

export { default as rootThunks } from './rootThunks';

type AppState = ReturnType<typeof rootReducers>;
type AppDispatch = typeof store.dispatch;

export const useAppDispatch = () => useDispatch<AppDispatch>();

export const useAppState = <T extends (state: AppState) => any>(selector: T): ReturnType<T> => useSelector(selector);

export const getAppState = (): AppState => store.getState();

export default store;
```

### useAppState

`useAppState` æ˜¯ä¸ªç”¨æ¥æ¶ˆè´¹çŠ¶æ€æ•°æ®çš„é’©å­ï¼Œå†…éƒ¨æ˜¯åŸºäº `useSelector` è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œè€Œå°è£…çš„ç¼˜ç”±åˆ™æ˜¯ä¸ºäº†è®©ä½¿ç”¨æ—¶èƒ½äº«å—åˆ°æä½³çš„TSä½“éªŒï¼Œä»¥åŠå°†å…¶é‡å‘½åä¸ºé€šä¿—æ˜“æ‡‚çš„åç§°ï¼Œæ›´æ¸…æ™°æ˜äº†ã€‚

```tsx title="ä½¿ç”¨ç¤ºä¾‹"
import { useAppState } from '@/store';

interface RouteAuthProps {}

const RouteAuth: React.FC<RouteAuthProps> = () => {
  const { menuList } = useAppState(state => state.user);

  return <div>{menuList}</div>;
};
```

### getAppState

`getAppState` ä¸»è¦ç”¨å¤„ä¸ `useAppState` ä¸€æ ·ï¼Œç”¨ä½œæ¶ˆè´¹çŠ¶æ€æ•°æ®ã€‚ä½†å®ƒå¹¶éé’©å­ï¼Œå¯ä»¥ç”¨å…¶åœ¨éç»„ä»¶çš„ç¯å¢ƒä¸‹æ¶ˆè´¹çŠ¶æ€æ•°æ®ã€‚

### useAppDispatch

`useAppDispatch` æ˜¯ä¸ªç”¨æ¥è°ƒèµ· Action è€Œè§¦å‘çŠ¶æ€æ•°æ®æ›´æ–°çš„é’©å­ï¼Œå†…éƒ¨æ˜¯åŸºäº `useDispatch` è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œè€Œå°è£…çš„ç¼˜ç”±åˆ™æ˜¯ä¿æŒä¸ `useAppState` ç»Ÿä¸€åŒ–ğŸ¤“

### rootActions

> å…·ä½“ä»£ç è¯·é˜… /src/store/rootActions.ts

`rootActions` æ˜¯æ‰€æœ‰çŠ¶æ€æ¨¡å—çš„ `Action` é›†åˆã€‚å®ƒçš„æ•°æ®ç±»å‹æ˜¯ `Record<çŠ¶æ€æ¨¡å—å, å¯¹åº”çš„Actionå¯¹è±¡>`ã€‚

ä¸ºä»€ä¹ˆè¦åšä¸€å±‚ `rootActions` æ”¶é›†å‘¢ï¼Ÿæ˜¯å› ä¸ºå®ƒèƒ½å…¨å±€æ§åˆ¶å¥½å„çŠ¶æ€æ¨¡å—çš„ `Action`ï¼Œä»€ä¹ˆæ—¶å€™è¯¥æ”¾å‡ºæ¥ï¼Œä»€ä¹ˆæ—¶å€™ä¸è¯¥æ”¾å‡ºæ¥ç­‰ç­‰ã€‚

ä»¥åŠåœ¨ä½¿ç”¨æ—¶å¯ç»Ÿä¸€é€šè¿‡ `rootActions` æ¥æ‹¿åˆ°å„çŠ¶æ€æ¨¡å—å†…çš„ `Action` ï¼Œå°½å¯èƒ½çš„æé«˜ä»£ç çš„å†…èšåŠ›

```tsx title="ä¸ useAppDispatch ä¸€èµ·ä½¿ç”¨çš„ç¤ºä¾‹"
import { rootActions, useAppDispatch } from '@/store';

interface LayoutHeaderProps {}

const LayoutHeader: React.FC<LayoutHeaderProps> = () => {
  const storeDispatch = useAppDispatch();

  const switchIsMenuCollapsed = () => {
    const { setIsMenuCollapsed } = rootActions.system;

    storeDispatch(setIsMenuCollapsed());
  };

  return (
    <div>
      <button onClick={switchIsMenuCollapsed}>åˆ‡æ¢èœå•æ”¶ç¼©çŠ¶æ€</button>
    </div>
  );
};
```

### rootThunks

`rootThunks` æ˜¯æ‰€æœ‰çŠ¶æ€æ¨¡å—çš„ `Thunk` é›†åˆã€‚å®ƒçš„æ•°æ®ç±»å‹æ˜¯ `Record<çŠ¶æ€æ¨¡å—å, å¯¹åº”çš„Thunkå¯¹è±¡>`ã€‚

`Thunk` çš„æ„ä¹‰åˆ™å¦‚ `redux-thunk` ä¸€èˆ¬ã€‚